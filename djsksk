local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local GuiService = game:GetService("GuiService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- ç¤ºä¾‹è„šæœ¬æ•°æ®ï¼ˆè¯·æ›¿æ¢ä¸ºæ‚¨çš„å®é™…è„šæœ¬é“¾æ¥ï¼‰
local scriptsData = {
    {name = "æ— é™è·³è·ƒ", url = "https://raw.githubusercontent.com/example/jump.lua"},
    {name = "é£è¡Œæ¨¡å¼", url = "https://raw.githubusercontent.com/example/fly.lua"},
    {name = "é€Ÿåº¦æå‡", url = "https://raw.githubusercontent.com/example/speed.lua"},
    {name = "ç©¿å¢™æ¨¡å¼", url = "https://raw.githubusercontent.com/example/noclip.lua"},
    {name = "ESPé€è§†", url = "https://raw.githubusercontent.com/example/esp.lua"},
    {name = "æ— æ•Œæ¨¡å¼", url = "https://raw.githubusercontent.com/example/godmode.lua"},
    {name = "è‡ªåŠ¨æ”¶é›†", url = "https://raw.githubusercontent.com/example/autofarm.lua"}
}

-- å­˜å‚¨å·²æ‰§è¡Œçš„è„šæœ¬å‡½æ•°ï¼Œç”¨äºæ¢å¤åŠŸèƒ½
local executedScripts = {}

-- è·å–å±å¹•å°ºå¯¸
local screenSize = workspace.CurrentCamera.ViewportSize
local isMobile = UserInputService.TouchEnabled

-- åˆ›å»ºä¸»ç•Œé¢
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "MobileScriptManager"
screenGui.Parent = playerGui
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- ç§»åŠ¨ç«¯é€‚é…çš„å°ºå¯¸
local buttonSize = math.min(screenSize.X * 0.2, 80)
local frameWidth = math.min(screenSize.X * 0.9, 400)

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, frameWidth, 0, screenSize.Y * 0.7)
mainFrame.Position = UDim2.new(0.5, -frameWidth/2, 0.5, -screenSize.Y * 0.35)
mainFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
mainFrame.BorderSizePixel = 0
mainFrame.ClipsDescendants = true
mainFrame.Parent = screenGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 12)
corner.Parent = mainFrame

-- æ ‡é¢˜æ ï¼ˆæ›´å¤§ä»¥é€‚åº”è§¦æ‘¸ï¼‰
local titleBar = Instance.new("Frame")
titleBar.Size = UDim2.new(1, 0, 0, 50)
titleBar.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
titleBar.BorderSizePixel = 0
titleBar.Parent = mainFrame

local titleCorner = Instance.new("UICorner")
titleCorner.CornerRadius = UDim.new(0, 12)
titleCorner.Parent = titleBar

local titleText = Instance.new("TextLabel")
titleText.Size = UDim2.new(1, 0, 1, 0)
titleText.Text = "ğŸ“± è„šæœ¬ç®¡ç†å™¨"
titleText.TextColor3 = Color3.fromRGB(255, 255, 255)
titleText.BackgroundTransparency = 1
titleText.Font = Enum.Font.GothamBold
titleText.TextSize = 18
titleText.Parent = titleBar

-- è„šæœ¬åˆ—è¡¨ï¼ˆæ»šåŠ¨è§†å›¾ï¼‰
local scriptsList = Instance.new("ScrollingFrame")
scriptsList.Size = UDim2.new(1, -20, 1, -120)
scriptsList.Position = UDim2.new(0, 10, 0, 60)
scriptsList.BackgroundTransparency = 1
scriptsList.ScrollBarThickness = 8
scriptsList.CanvasSize = UDim2.new(0, 0, 0, 0)
scriptsList.Parent = mainFrame

local listLayout = Instance.new("UIListLayout")
listLayout.Padding = UDim.new(0, 12)
listLayout.Parent = scriptsList

-- æ§åˆ¶æŒ‰é’®åŒºåŸŸ
local controlPanel = Instance.new("Frame")
controlPanel.Size = UDim2.new(1, -20, 0, 60)
controlPanel.Position = UDim2.new(0, 10, 1, -70)
controlPanel.BackgroundTransparency = 1
controlPanel.Parent = mainFrame

local controlLayout = Instance.new("UIListLayout")
controlLayout.FillDirection = Enum.FillDirection.Horizontal
controlLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
controlLayout.VerticalAlignment = Enum.VerticalAlignment.Center
controlLayout.Padding = UDim.new(0, 15)
controlLayout.Parent = controlPanel

-- åˆ›å»ºæ§åˆ¶æŒ‰é’®å‡½æ•°ï¼ˆæ›´å¤§çš„æŒ‰é’®ï¼‰
local function createControlButton(text, color, size)
    local button = Instance.new("TextButton")
    button.Size = UDim2.new(0, size, 0, 50)
    button.BackgroundColor3 = color
    button.Text = text
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.Font = Enum.Font.GothamBold
    button.TextSize = 16
    button.AutoButtonColor = false
    
    local buttonCorner = Instance.new("UICorner")
    buttonCorner.CornerRadius = UDim.new(0, 10)
    buttonCorner.Parent = button
    
    return button
end

-- åˆ›å»ºæ§åˆ¶æŒ‰é’®
local hideButton = createControlButton("éšè—", Color3.fromRGB(200, 50, 50), 100)
hideButton.Parent = controlPanel

local restoreButton = createControlButton("æ¢å¤", Color3.fromRGB(50, 150, 50), 100)
restoreButton.Parent = controlPanel

-- åˆ›å»ºæ˜¾ç¤º/éšè—æŒ‰é’®ï¼ˆæµ®åŠ¨æŒ‰é’®ï¼‰
local toggleButton = Instance.new("TextButton")
toggleButton.Size = UDim2.new(0, buttonSize, 0, buttonSize)
toggleButton.Position = UDim2.new(0, 20, 0, screenSize.Y - buttonSize - 20)
toggleButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
toggleButton.Text = "ğŸ“±"
toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleButton.Font = Enum.Font.GothamBold
toggleButton.TextSize = 24
toggleButton.Parent = screenGui

local toggleCorner = Instance.new("UICorner")
toggleCorner.CornerRadius = UDim.new(0, buttonSize/2)
toggleCorner.Parent = toggleButton

-- åˆ›å»ºè„šæœ¬æŒ‰é’®å‡½æ•°ï¼ˆæ›´å¤§çš„æŒ‰é’®ï¼‰
local function createScriptButton(scriptData, index)
    local button = Instance.new("TextButton")
    button.Size = UDim2.new(1, 0, 0, 60)
    button.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    button.Text = "â–¶ " .. scriptData.name
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.Font = Enum.Font.GothamBold
    button.TextSize = 16
    button.AutoButtonColor = false
    button.TextXAlignment = Enum.TextXAlignment.Left
    button.Padding = Left = UDim.new(0, 15)
    
    local buttonCorner = Instance.new("UICorner")
    buttonCorner.CornerRadius = UDim.new(0, 10)
    buttonCorner.Parent = button
    
    -- æ·»åŠ å›¾æ ‡
    local icon = Instance.new("TextLabel")
    icon.Size = UDim2.new(0, 30, 0, 30)
    icon.Position = UDim2.new(1, -40, 0.5, -15)
    icon.Text = "âš¡"
    icon.TextColor3 = Color3.fromRGB(255, 255, 255)
    icon.BackgroundTransparency = 1
    icon.Font = Enum.Font.GothamBold
    icon.TextSize = 18
    icon.Parent = button
    
    button.MouseButton1Click:Connect(function()
        -- ç‚¹å‡»åé¦ˆ
        local originalColor = button.BackgroundColor3
        button.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
        
        task.spawn(function()
            task.wait(0.1)
            button.BackgroundColor3 = originalColor
        end)
        
        local success, result = pcall(function()
            -- è·å–è„šæœ¬å†…å®¹
            local scriptContent = game:HttpGet(scriptData.url)
            -- æ‰§è¡Œè„šæœ¬
            local scriptFunction = loadstring(scriptContent)
            if scriptFunction then
                executedScripts[scriptData.name] = scriptFunction
                scriptFunction()
                return true
            end
            return false
        end)
        
        if not success then
            warn("è„šæœ¬æ‰§è¡Œå¤±è´¥: " .. tostring(result))
        end
    end)
    
    return button
end

-- å¡«å……è„šæœ¬åˆ—è¡¨
for i, scriptData in ipairs(scriptsData) do
    local scriptButton = createScriptButton(scriptData, i)
    scriptButton.Parent = scriptsList
end

-- æ›´æ–°åˆ—è¡¨å¤§å°
listLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    scriptsList.CanvasSize = UDim2.new(0, 0, 0, listLayout.AbsoluteContentSize.Y)
end)

-- æ˜¾ç¤º/éšè—åŠŸèƒ½
local isVisible = true

local function toggleVisibility()
    isVisible = not isVisible
    
    local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    
    if isVisible then
        local tween = TweenService:Create(mainFrame, tweenInfo, {Position = UDim2.new(0.5, -frameWidth/2, 0.5, -screenSize.Y * 0.35)})
        tween:Play()
        toggleButton.Text = "ğŸ“±"
    else
        local tween = TweenService:Create(mainFrame, tweenInfo, {Position = UDim2.new(1.5, -frameWidth/2, 0.5, -screenSize.Y * 0.35)})
        tween:Play()
        toggleButton.Text = "ğŸ“±"
    end
end

toggleButton.MouseButton1Click:Connect(toggleVisibility)

-- éšè—æŒ‰é’®åŠŸèƒ½
hideButton.MouseButton1Click:Connect(function()
    toggleVisibility()
end)

-- æ¢å¤åŠŸèƒ½ï¼ˆé‡æ–°æ‰§è¡Œæ‰€æœ‰å·²æ‰§è¡Œçš„è„šæœ¬ï¼‰
restoreButton.MouseButton1Click:Connect(function()
    for scriptName, scriptFunction in pairs(executedScripts) do
        local success, errorMsg = pcall(function()
            scriptFunction()
        end)
        
        if not success then
            warn("è„šæœ¬æ¢å¤å¤±è´¥ (" .. scriptName .. "): " .. errorMsg)
        end
    end
end)

-- æŒ‰é’®æ‚¬åœæ•ˆæœï¼ˆç§»åŠ¨ç«¯ä¼˜åŒ–ï¼‰
local function setupButtonHover(button, originalColor)
    if not isMobile then
        button.MouseEnter:Connect(function()
            button.BackgroundColor3 = originalColor:Lerp(Color3.fromRGB(255, 255, 255), 0.2)
        end)
        
        button.MouseLeave:Connect(function()
            button.BackgroundColor3 = originalColor
        end)
    end
end

-- è®¾ç½®æŒ‰é’®æ‚¬åœæ•ˆæœ
setupButtonHover(hideButton, Color3.fromRGB(200, 50, 50))
setupButtonHover(restoreButton, Color3.fromRGB(50, 150, 50))
setupButtonHover(toggleButton, Color3.fromRGB(60, 60, 60))

for _, button in ipairs(scriptsList:GetChildren()) do
    if button:IsA("TextButton") then
        setupButtonHover(button, Color3.fromRGB(60, 60, 60))
    end
end

-- æ‹–æ‹½åŠŸèƒ½ï¼ˆç§»åŠ¨ç«¯é€‚é…ï¼‰
local dragging = false
local dragStart, startPos

titleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

titleBar.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch then
        dragStart = input.Position
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseMovement) then
        local delta = input.Position - dragStart
        mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, 
                                      startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        dragStart = input.Position
    end
end)

-- ç¡®ä¿ç•Œé¢åœ¨å±å¹•å†…
local function ensureInBounds()
    local viewportSize = workspace.CurrentCamera.ViewportSize
    local absPos = mainFrame.AbsolutePosition
    local absSize = mainFrame.AbsoluteSize
    
    local newX = math.clamp(absPos.X, 0, viewportSize.X - absSize.X)
    local newY = math.clamp(absPos.Y, 0, viewportSize.Y - absSize.Y)
    
    if absPos.X ~= newX or absPos.Y ~= newY then
        mainFrame.Position = UDim2.new(0, newX, 0, newY)
    end
end

-- å®šæœŸæ£€æŸ¥è¾¹ç•Œ
RunService.Heartbeat:Connect(ensureInBounds)

-- é€‚é…å®‰å…¨åŒºåŸŸï¼ˆé¿å…è¢«åˆ˜æµ·æˆ–çŠ¶æ€æ é®æŒ¡ï¼‰
if GuiService:GetSafeZoneOffsets then
    local safeZone = GuiService:GetSafeZoneOffsets()
    toggleButton.Position = UDim2.new(0, 20 + safeZone.X, 0, screenSize.Y - buttonSize - 20 - safeZone.Y)
end

print("ğŸ“± æ‰‹æœºç‰ˆè„šæœ¬ç®¡ç†å™¨å·²åŠ è½½ï¼")
print("ä½¿ç”¨æ–¹æ³•ï¼š")
print("1. ç‚¹å‡»è„šæœ¬åç§°æ‰§è¡Œå¯¹åº”è„šæœ¬")
print("2. ç‚¹å‡»'æ¢å¤'é‡æ–°æ‰§è¡Œæ‰€æœ‰å·²æ‰§è¡Œçš„è„šæœ¬")
print("3. ç‚¹å‡»'éšè—'æˆ–æµ®åŠ¨æŒ‰é’®éšè—/æ˜¾ç¤ºç•Œé¢")
print("4. æ‹–æ‹½æ ‡é¢˜æ å¯ä»¥ç§»åŠ¨ç•Œé¢")
